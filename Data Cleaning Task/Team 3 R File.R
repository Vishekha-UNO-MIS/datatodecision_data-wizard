install.packages("readxl")
library("readxl")

##Import csv file, skip the first 2 rows, and use the 3rd row as header
my_data<-read_excel("C:/Users/hatha/Desktop/DataExploration/MasterWaterQualityEntryTempAdded.xlsx",sheet="Sheet1", skip = 2,col_types =NULL ,col_names = TRUE)

##Remove the first row since it is a unit row
dataset <- my_data [-c (1),]

##Filter 2013-2017 data
newdata1<- subset(dataset,dataset$Year>2012 & dataset$Year<2018)

##Combine Day, Month, & Year columns into Date column
newdata1$Date <- as.Date(with(newdata1, paste(Year, Month, Day,sep="-")), "%Y-%m-%d")

##Remove unnecessary columns 
newdata2<-newdata1[,c(4,5,6,8,10,11,12,13,17,24,25,46,47,50,53)]

##Rename header names
names (newdata2)[2]<- "ObservationSite"
names (newdata2)[3]<- "TempF"
names (newdata2)[4]<- "Precipitation"
names (newdata2)[5]<- "WaterTemp"
names (newdata2)[8]<- "DissolvedOxygen"
names (newdata2)[10]<- "FloatAverage"
names (newdata2)[13]<- "Phosphates"
names (newdata2)[14]<- "Sulfate"
names (newdata2)[15]<- "Alkalinity"


##Use after put in the means and calculations to fill empty cells and change nv cells to NA
Newdata2[newdata2=="nv"]<-NA
Newdata2[newdata2==""]<-NA

##View function to view value of the table
View(newdata1)

##Write Function
write.csv(newdata1,"reviseddata.csv")






## Capitalized first letter in observation site

> capFirst<- function(s){
  + paste(toupper(substring(s, 1, 1)), substring(s, 2), sep = "")
  + }
> newdata2$ObservationSite<-capFirst(newdata2$ObservationSite)
> newdata2


## Replaced NA with the mean value of Water temp

> data1<-newdata2
> data1$WaterTemp= as.numeric(as.character(data1$WaterTemp))
> data1$WaterTemp[which(is.na(data1$WaterTemp))]<-mean(data1$WaterTemp,na.rm= TRUE)




#pH Column Missing Values
#Observation for pH value was missing in many data cells.Finding missing value by taking out mean of all the pH values that were recorded in a particular year 

#For the year 2013,
df<-data.frame(x=c(7.6,
                   8.1,
                   8.1,
                   7.1,
                   7.7,
                   8.5,
                   8.1,
                   8.3,
                   8.5,
                   7.8,
                   8.3,
                   NA,
                   8.4,
                   8.4,
                   8.3,
                   8.1,
                   8.4,
                   8.3,
                   8,
                   7.9,
                   8.3,
                   NA,
                   NA,
                   7.9,
                   NA,
                   8.8,
                   8.5,
                   8.8,
                   7.9,
                   8.2,
                   8.1,
                   7.9,
                   8.3,
                   8,
                   8.5,
                   8.3,
                   8.1,
                   8.1,
                   8.7,
                   8.3,
                   8.3,
                   8.7,
                   NA,
                   8.6,
                   7.1,
                   7.5,
                   7.1,
                   6.9,
                   7.8,
                   8,
                   7.7,
                   7.7,
                   8.1,
                   7.9,
                   8.1,
                   8.3,
                   7.9,
                   7.9,
                   8.7,
                   9.1,
                   7.9,
                   8.3,
                   7.9,
                   8.8,
                   8.5,
                   8.9))
mean(df$x,na.rm = TRUE) 
#8.136066

#For the year 2014
df<-data.frame(x=c(8.4,
                   8.6,
                   7.5,
                   8.1,
                   8,
                   7.5,
                   8.2,
                   8,
                   8.4,
                   8.2,
                   8.2,
                   8.1,
                   8.9,
                   8.4,
                   8.2,
                   8.2,
                   9.3,
                   8.05,
                   7.6,
                   7.8,
                   7.8,
                   8.8,
                   8.2,
                   8.2,
                   8.6,
                   8.6,
                   8.3,
                   8.4,
                   8.25,
                   8.6,
                   7.2,
                   7.9,
                   7.6,
                   7.6,
                   8.3,
                   7.5,
                   7.6,
                   8,
                   8.6,
                   8.4,
                   8.65,
                   8.6,
                   8.5,
                   8.1,
                   8.4,
                   8,
                   8.7,
                   7.9,
                   8.6,
                   8,
                   9.2,
                   NA,
                   8.6,
                   NA,
                   8.7,
                   8.4,
                   7.3,
                   8.3,
                   7.7,
                   7.6,
                   8.8,
                   8,
                   7.8,
                   8.3,
                   8.3,
                   7.3,
                   7.8,
                   7.6,
                   7.6,
                   7.9,
                   5.5,
                   7,
                   7.4,
                   7.9,
                   7.4,
                   6.9,
                   8.2,
                   8.2,
                   8,
                   8.1,
                   8.1,
                   8.4,
                   8.4,
                   8.4,
                   7.6,
                   7.8,
                   8.4,
                   7.5,
                   8.7,
                   8.4))
mean(df$x,na.rm = TRUE) 
#8.080114

#For the year 2015
df<-data.frame(x=c(7.9,
                   8.1,
                   8.1,
                   8.3,
                   7.16,
                   7.9,
                   8,
                   7.4,
                   7.6,
                   8,
                   NA,
                   8,
                   7.8,
                   8,
                   8.1,
                   8,
                   8,
                   7.8,
                   7.9,
                   8.15,
                   8.1,
                   8,
                   NA,
                   8,
                   7,
                   7.8,
                   8.3,
                   7.9,
                   8.8,
                   8.65,
                   8.6,
                   8.43,
                   8.4,
                   8.1,
                   7.55,
                   8.9,
                   8.3,
                   8.85,
                   8.8,
                   8.2,
                   8.5,
                   NA,
                   8.6,
                   8.55))
mean(df$x,na.rm = TRUE) 
#8.110732

#For the year 2016
df<-data.frame(x=c(NA,
                   8.6,
                   NA,
                   NA,
                   9.4,
                   8.2,
                   8.2,
                   8.4,
                   7.7,
                   8.8,
                   NA,
                   8.5,
                   NA,
                   7.9,
                   8.1,
                   8.6,
                   8.3,
                   8.1,
                   8.1,
                   8.4,
                   8.4,
                   8.4,
                   8,
                   7.8,
                   8.1,
                   8,
                   7.9,
                   7.9,
                   8.5,
                   8.2,
                   7.7,
                   7.9,
                   8.1,
                   8.3,
                   8.25,
                   8.1,
                   7.8,
                   8.1,
                   8.1,
                   7.6,
                   7.6,
                   8,
                   7.7,
                   7.8,
                   NA,
                   7.2,
                   7.9,
                   8.1,
                   7.5,
                   7.6,
                   8.2,
                   8.4,
                   8.1,
                   7.8,
                   8.3,
                   8.5,
                   8.3,
                   7.8,
                   NA,
                   8.2,
                   7.9,
                   7.9,
                   7.9,
                   8.4,
                   8.2,
                   7.8,
                   8,
                   8.1,
                   8.2,
                   8,
                   8.2,
                   8,
                   8,
                   7.8,
                   8.2,
                   7.8,
                   7.09,
                   6.9,
                   NA,
                   NA,
                   NA,
                   7.2,
                   7.2,
                   8.3,
                   8.4,
                   7.7,
                   7.1,
                   7.1,
                   7.1,
                   7.8,
                   7.8,
                   7.5,
                   7.85,
                   8,
                   8,
                   7.59,
                   8,
                   NA,
                   8.4,
                   7.9,
                   8,
                   8.1,
                   8.1,
                   8,
                   8.3,
                   8.2,
                   8.265))
mean(df$x,na.rm = TRUE) 
#7.997344

#For the year 2017
df<-data.frame(x=c(8.5,
                   9,
                   8,
                   7.5,
                   8,
                   8.5,
                   7.66,
                   NA,
                   6.05,
                   6.8,
                   NA,
                   7.4,
                   8,
                   7.8,
                   7.8,
                   7.7,
                   7.9,
                   7,
                   8,
                   7.4,
                   7.9,
                   7.55,
                   8.3,
                   8.05,
                   8.1,
                   7.4,
                   8.1,
                   7.8,
                   8.4,
                   8.25,
                   NA,
                   6.4,
                   7.2,
                   NA,
                   6.8,
                   8.5,
                   8.7,
                   8.6,
                   8.9,
                   8.1,
                   8.2,
                   8,
                   7.95))
mean(df$x,na.rm = TRUE) 
#7.851538

#Conductivity Column Missing Values
#Observation for Conductivity was missing in many data cells.Finding missing value by taking out mean of all the Conductivity values that were recorded in the year 2016

#For the year 2013,
df<-data.frame(x=c(1360,
                   470,
                   500,
                   440,
                   550,
                   130,
                   550,
                   530,
                   530,
                   490,
                   480,
                   650,
                   510,
                   NA,
                   130,
                   270,
                   130,
                   160,
                   360,
                   370,
                   150,
                   1410,
                   840,
                   870,
                   390,
                   380,
                   620,
                   10,
                   160,
                   410,
                   420,
                   160,
                   130,
                   NA,
                   430,
                   130,
                   140,
                   420,
                   380,
                   130,
                   250,
                   NA,
                   480,
                   520,
                   140,
                   500,
                   140,
                   NA,
                   170,
                   470,
                   170,
                   300,
                   140,
                   520,
                   530,
                   130,
                   NA,
                   580,
                   520,
                   510,
                   130,
                   310,
                   120,
                   640,
                   370,
                   540))
mean(df$x,na.rm = TRUE) 
#399.5082

#For the year 2014
df<-data.frame(x=c(580,
                   NA,
                   650,
                   650,
                   120,
                   400,
                   390,
                   120,
                   120,
                   600,
                   600,
                   590,
                   100,
                   640,
                   10,
                   600,
                   740,
                   625,
                   110,
                   540,
                   580,
                   110,
                   90,
                   300,
                   350,
                   80,
                   600,
                   NA,
                   645,
                   500,
                   120,
                   540,
                   540,
                   130,
                   620,
                   120,
                   460,
                   460,
                   120,
                   740,
                   740,
                   700,
                   705,
                   520,
                   130,
                   260,
                   120,
                   280,
                   100,
                   500,
                   100,
                   730,
                   10,
                   730,
                   720,
                   540,
                   100,
                   780,
                   510,
                   500,
                   510,
                   450,
                   NA,
                   460,
                   130,
                   130,
                   490,
                   490,
                   130,
                   550,
                   580,
                   120,
                   550,
                   590,
                   120,
                   10,
                   530,
                   NA,
                   130,
                   540,
                   540,
                   550,
                   120,
                   600,
                   130,
                   NA,
                   570,
                   120,
                   100,
                   100))
mean(df$x,na.rm = TRUE) 
#393

#For the year 2015
df<-data.frame(x=c(130,
                   590,
                   590,
                   130,
                   130,
                   540,
                   540,
                   130,
                   660,
                   630,
                   640,
                   6.55,
                   480,
                   570,
                   590,
                   58.5,
                   620,
                   610,
                   630,
                   620,
                   660,
                   630,
                   630,
                   665,
                   660,
                   250,
                   245,
                   250,
                   890,
                   855,
                   860,
                   816.7,
                   630,
                   6.4,
                   NA,
                   546.7,
                   540,
                   10,
                   583.3,
                   550,
                   660,
                   640,
                   650,
                   664.5))
mean(df$x,na.rm = TRUE) 
#506.6895

#For the year 2016
df<-data.frame(x=c(530,
                   560,
                   515,
                   530,
                   610,
                   620,
                   600,
                   610,
                   300,
                   650,
                   NA,
                   640,
                   NA,
                   100,
                   100,
                   653,
                   66,
                   100,
                   666,
                   640,
                   670,
                   650,
                   100,
                   110,
                   620,
                   590,
                   110,
                   110,
                   680,
                   600,
                   110,
                   115,
                   5.2,
                   510,
                   510,
                   390,
                   120,
                   590,
                   600,
                   120,
                   230,
                   210,
                   130,
                   330,
                   NA,
                   130,
                   NA,
                   NA,
                   130,
                   140,
                   630,
                   630,
                   140,
                   140,
                   600,
                   650,
                   140,
                   140,
                   NA,
                   680,
                   670,
                   140,
                   140,
                   530,
                   490,
                   150,
                   140,
                   310,
                   310,
                   140,
                   440,
                   140,
                   470,
                   480,
                   140,
                   535,
                   450,
                   440,
                   NA,
                   NA,
                   NA,
                   540,
                   540,
                   530,
                   530,
                   150,
                   580,
                   580,
                   160,
                   610,
                   540,
                   460,
                   537.5,
                   550,
                   580,
                   609,
                   620,
                   540,
                   620,
                   650,
                   650,
                   650,
                   780,
                   690,
                   NA,
                   700,
                   680))
mean(df$x,na.rm = TRUE) 
#423.1103

#For the year 2017
df<-data.frame(x=c(630,
                   630,
                   290,
                   270,
                   550,
                   545,
                   410,
                   480,
                   500,
                   470,
                   NA,
                   520,
                   530,
                   370,
                   440,
                   NA,
                   440,
                   440,
                   430,
                   NA,
                   480,
                   480,
                   640,
                   NA,
                   620,
                   570,
                   660,
                   650,
                   690,
                   680,
                   600,
                   660,
                   420,
                   475,
                   470,
                   540,
                   590,
                   570,
                   NA,
                   510,
                   510,
                   550,
                   535))
mean(df$x,na.rm = TRUE)  
#522.2368


#Dissolved Oxygen mg/L Column Missing Values
#Observation for Dissolved Oxygen mg/ was missing in many data cells.Finding missing value by taking out mean of all the Dissolved Oxygen mg/L values that were recorded in a particular year 

#For the year 2013,
df<-data.frame(x=c(4.5,
                   4.52,
                   5.5,
                   5.5,
                   5.2,
                   8.21,
                   8.85,
                   10.95,
                   10.95,
                   9,
                   8,
                   12,
                   6,
                   10,
                   2.47,
                   10.41,
                   2.34,
                   7.35,
                   6.52,
                   7.5,
                   7.18,
                   17,
                   7,
                   11,
                   12,
                   10,
                   11,
                   14.4,
                   3.7,
                   6.7,
                   7.45,
                   3.56,
                   8.45,
                   9.26,
                   10.03,
                   6.53,
                   7.54,
                   9.34,
                   9.9,
                   7.74,
                   11.12,
                   NA,
                   12,
                   13,
                   6.55,
                   5.23,
                   5.5,
                   12,
                   0.9,
                   6.42,
                   1.5,
                   5.62,
                   10,
                   9.93,
                   10.47,
                   10.47,
                   10,
                   10,
                   10,
                   20,
                   7.28,
                   7.25,
                   6.37,
                   NA,
                   9,
                   NA))
mean(df$x,na.rm = TRUE) 
#8.351746

#For the year 2014
df<-data.frame(x=c(15,
                   20,
                   8,
                   11,
                   4.19,
                   7.75,
                   8.68,
                   4.5,
                   91.2,
                   NA,
                   NA,
                   105.3,
                   106.3,
                   12,
                   11,
                   8,
                   15,
                   7,
                   4.01,
                   6.2,
                   6.85,
                   4.55,
                   5.36,
                   9.76,
                   10.06,
                   3.59,
                   14,
                   10,
                   9,
                   9,
                   2.2,
                   6.12,
                   5.51,
                   2.9,
                   6,
                   5.07,
                   8.4,
                   11.21,
                   3.1,
                   14,
                   6,
                   15,
                   13,
                   13.5,
                   1.92,
                   10.36,
                   1.46,
                   10.45,
                   6.39,
                   10.37,
                   7.92,
                   12,
                   10,
                   4,
                   3,
                   14,
                   5.55,
                   10.14,
                   10.02,
                   4.81,
                   6.15,
                   91.4,
                   NA,
                   105.6,
                   36.2,
                   5,
                   7.09,
                   7.4,
                   3.9,
                   9,
                   4,
                   2.1,
                   4.4,
                   7.29,
                   3.83,
                   16,
                   8,
                   NA,
                   73,
                   NA,
                   NA,
                   81.3,
                   76,
                   9,
                   7.92,
                   8.7,
                   10.5,
                   2.1,
                   4.81,
                   4.37))
mean(df$x,na.rm = TRUE) 
#16.1519

#For the year 2015
df<-data.frame(x=c(NA,
                   NA,
                   NA,
                   NA,
                   NA,
                   NA,
                   NA,
                   NA,
                   10,
                   10,
                   9,
                   8,
                   5.6,
                   8,
                   7,
                   11,
                   6,
                   7,
                   5,
                   10,
                   10,
                   8,
                   8,
                   10,
                   13,
                   7.5,
                   7,
                   12,
                   12,
                   7,
                   8,
                   8,
                   10,
                   13,
                   16,
                   9,
                   NA,
                   6,
                   8,
                   14,
                   14,
                   13,
                   14,
                   15))
mean(df$x,na.rm = TRUE) 
# 9.688571

#For the year 2016
df<-data.frame(x=c(12,
                   9,
                   NA,
                   NA,
                   NA,
                   7,
                   NA,
                   13,
                   7.8,
                   8,
                   NA,
                   10,
                   NA,
                   8.26,
                   8.24,
                   17,
                   9,
                   7.8,
                   10,
                   NA,
                   8,
                   16.1,
                   7.76,
                   6.57,
                   7.14,
                   7.9,
                   4.49,
                   5.7,
                   4.55,
                   9.4,
                   6.05,
                   5.65,
                   10,
                   7.78,
                   10,
                   9.44,
                   6.7,
                   9,
                   5,
                   5.07,
                   5.97,
                   6.04,
                   3.08,
                   8,
                   10,
                   4.79,
                   6.2,
                   6.61,
                   4.89,
                   3.95,
                   10.1,
                   9.65,
                   NA,
                   6.04,
                   8.43,
                   8.47,
                   5.64,
                   5.67,
                   NA,
                   4.82,
                   6.07,
                   4.73,
                   3.7,
                   6.49,
                   7.34,
                   4.32,
                   5.8,
                   8.72,
                   8.86,
                   5.8,
                   8.45,
                   10.8,
                   9.76,
                   8.43,
                   10.84,
                   5.575,
                   7,
                   7,
                   NA,
                   NA,
                   NA,
                   7,
                   7,
                   6,
                   6,
                   7.93,
                   7.29,
                   10.76,
                   2.54,
                   7,
                   10.44,
                   10,
                   10,
                   10,
                   11,
                   7,
                   10,
                   5,
                   9,
                   7.6,
                   11.08,
                   11.54,
                   8,
                   14.2,
                   11,
                   9,
                   6))
mean(df$x,na.rm = TRUE) 
#7.892789

#For the year 2017
df<-data.frame(x=c(11,
                   19,
                   10.9,
                   10.9,
                   16,
                   10,
                   8.69,
                   7,
                   7,
                   7,
                   NA,
                   9,
                   12,
                   7.2,
                   4,
                   6,
                   7,
                   8,
                   10,
                   7,
                   10,
                   12,
                   8,
                   7,
                   11,
                   12,
                   13,
                   8,
                   14,
                   13,
                   14,
                   15,
                   8.67,
                   5.8,
                   7,
                   15,
                   14.5,
                   16,
                   16,
                   8,
                   11,
                   17,
                   12))
mean(df$x,na.rm = TRUE) 
#10.61095


