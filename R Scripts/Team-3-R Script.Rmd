---
title: "Team 3 R Script"
author: "Vishekha, Vincent, Nishi and Malik"
date: "11/5/2019"
output: html_document
---

-------------------------------------#Analyis of pH value of Water for North site#---------------------------------------------------------

```{r}

# Number of observations and number of variables in the data set
dim(North_Site)
# Output
# 264 rows   8columns
```


```{r}
# names of all variables in the data set
names(North_Site)
```

```{r}

# Values of the variables in string format 
str(North_Site)

```

```{r}
#Summary of the data set
summary(North_Site)
```

```{r}

#Drop Site Inorder to Calculate Covariance
North_Site1 <- North_Site[-2]
View(North_Site1)
```

```{r}
#calculating covariance
cor(North_Site1)
# pH has negative correlation of -0.04136372 with Total Phosphate for North Site
# pH has negative correlation of -0.21096814 with Nitrates for North Site

```

```{r}
#Building Model
lm1=lm(formula = North_Site$pH~North_Site$`Dissolved Oxygen`)
summary(lm1)
# Output
Call:
  lm(formula = North_Site$pH ~ North_Site$`Dissolved Oxygen`)

Residuals:
  Min       1Q   Median       3Q      Max 
-2.53281 -0.16753  0.03272  0.25608  1.34558 

Coefficients:
  Estimate Std. Error t value Pr(>|t|)    
(Intercept)                   8.010588   0.042980 186.378   <2e-16 ***
  North_Site$`Dissolved Oxygen` 0.005555   0.002968   1.872   0.0624 .  
---
  Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.4781 on 262 degrees of freedom
Multiple R-squared:  0.0132,	Adjusted R-squared:  0.009429 
F-statistic: 3.503 on 1 and 262 DF,  p-value: 0.06236
```

```{r}
# calculate the regression ANOVA 
SSTotal <- var( North_Site$pH ) * (nrow(North_Site)-1)
SSE     <- sum( lm1$resid^2 )
SSreg   <- SSTotal - SSE
dfE   <- lm1$df.residual
dfReg <- nrow(North_Site) - 1 - dfE
MSreg <- SSreg / dfReg
MSE   <- SSE / dfE
(Fstat <- MSreg / MSE) # compare this with the summary() result earlier
# 3.503382
(pval  <- pf( Fstat , dfReg, dfE , lower.tail=FALSE )) # compare this with the summary() result earlier
# 0.06235779
# Since P-value is greater than the significance level(0.05) indicating that there is insufficient evidence in our sample to conclude that a non-zero correlation exists.
# Therefore we conclude that changes in the predictor are not associated with changes in the response.
# Also,The R-squared is 0.009429, so the model can explain 0.9% % of the variability of the response variable which is very low.
```

```{r}
#Building Model
lm2=lm(formula = North_Site$pH~North_Site$Alkalinity)
summary(lm2)
# Output
Call:
  lm(formula = North_Site$pH ~ North_Site$Alkalinity)

Residuals:
  Min       1Q   Median       3Q      Max 
-2.57322 -0.17261  0.03007  0.26955  1.33701 

Coefficients:
  Estimate Std. Error t value Pr(>|t|)    
(Intercept)            8.1033583  0.1474554  54.955   <2e-16 ***
  North_Site$Alkalinity -0.0001238  0.0005240  -0.236    0.813    
---
  Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.4813 on 262 degrees of freedom
Multiple R-squared:  0.0002131,	Adjusted R-squared:  -0.003603 
F-statistic: 0.05584 on 1 and 262 DF,  p-value: 0.8134
```

```{r}

# calculate the regression ANOVA 
SSTotal <- var( North_Site$pH ) * (nrow(North_Site)-1)
SSE     <- sum( lm2$resid^2 )
SSreg   <- SSTotal - SSE
dfE   <- lm2$df.residual
dfReg <- nrow(North_Site) - 1 - dfE
MSreg <- SSreg / dfReg
MSE   <- SSE / dfE
(Fstat <- MSreg / MSE) # compare this with the summary() result earlier
# 0.05584194
(pval  <- pf( Fstat , dfReg, dfE , lower.tail=FALSE )) # compare this with the summary() result earlier
# 0.8133776
# Since P-value  is greater than the significance level(0.05) indicating that there is insufficient evidence in our sample to conclude that a non-zero correlation exists.
# Therefore we conclude that changes in the predictor are not associated with changes in the response.
# Also,The R-squared is -0.003603, so the model can explain -0.3% % of the variability of the response variable which is very low and negative.
```


-------------------------------------------#Analyis of pH value of Water for West site#---------------------------------------

```{r}

# Number of observations and number of variables in the data set
dim(West_Site)
# Output
# 122 rows   8columns
```

```{r}
# names of all variables in the data set
names(West_Site) 
```

```{r}
# Values of the variables in string format 
str(West_Site)
```

```{r}
#Summary of the data set
summary(West_Site)
```

```{r}
#Drop Site Inorder to Calculate Covariance
West_Site1 <- West_Site[-2]
View(West_Site1)
```

```{r}

#calculating covariance
cor(West_Site1)

# pH has negative correlation of -0.20965277 with Total phosphate for West Site
```

```{r}
#Building Model
lm3=lm(formula = West_Site$pH~West_Site$`Dissolved Oxygen`)
summary(lm3)
# Output

Call:
  lm(formula = West_Site$pH ~ West_Site$`Dissolved Oxygen`)

Residuals:
  Min       1Q   Median       3Q      Max 
-2.58104 -0.15099  0.01487  0.30441  1.18132 

Coefficients:
  Estimate Std. Error t value Pr(>|t|)    
(Intercept)                  8.067357   0.066166 121.927   <2e-16 ***
  West_Site$`Dissolved Oxygen` 0.003422   0.003590   0.953    0.342    
---
  Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.5581 on 120 degrees of freedom
Multiple R-squared:  0.007516,	Adjusted R-squared:  -0.0007552 
F-statistic: 0.9087 on 1 and 120 DF,  p-value: 0.3424
```


```{r}
# calculate the regression ANOVA 
SSTotal <- var( West_Site$pH ) * (nrow(West_Site)-1)
SSE     <- sum( lm3$resid^2 )
SSreg   <- SSTotal - SSE
dfE   <- lm3$df.residual
dfReg <- nrow(West_Site) - 1 - dfE
MSreg <- SSreg / dfReg
MSE   <- SSE / dfE
(Fstat <- MSreg / MSE) # compare this with the summary() result earlier
# 0.9086939
(pval  <- pf( Fstat , dfReg, dfE , lower.tail=FALSE )) # compare this with the summary() result earlier
# 0.3423774
# Since P-value  is greater than the significance level(0.05) indicating that there is insufficient evidence in our sample to conclude that a non-zero correlation exists.
# Therefore we conclude that changes in the predictor are not associated with changes in the response.
```


```{r}
#Building Model
lm4=lm(formula = West_Site$pH~West_Site$Alkalinity)
summary(lm4)
# Output
Call:
  lm(formula = West_Site$pH ~ West_Site$Alkalinity)

Residuals:
  Min       1Q   Median       3Q      Max 
-2.57613 -0.16532  0.02387  0.31488  1.22387 

Coefficients:
  Estimate Std. Error t value Pr(>|t|)    
(Intercept)          7.7244730  0.2496396  30.943   <2e-16 ***
  West_Site$Alkalinity 0.0014449  0.0009211   1.569    0.119    
---
  Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.5546 on 120 degrees of freedom
Multiple R-squared:  0.02009,	Adjusted R-squared:  0.01193 
F-statistic: 2.461 on 1 and 120 DF,  p-value: 0.1194

```

```{r}
# calculate the regression ANOVA 
SSTotal <- var( West_Site$pH ) * (nrow(West_Site)-1)
SSE     <- sum( lm4$resid^2 )
SSreg   <- SSTotal - SSE
dfE   <- lm4$df.residual
dfReg <- nrow(West_Site) - 1 - dfE
MSreg <- SSreg / dfReg
MSE   <- SSE / dfE
(Fstat <- MSreg / MSE) # compare this with the summary() result earlier
# 2.460743
(pval  <- pf( Fstat , dfReg, dfE , lower.tail=FALSE )) # compare this with the summary() result earlier
# 0.1193568
# Since P-value is greater than the significance level(0.05) indicating that there is insufficient evidence in our sample to conclude that a non-zero correlation exists.
# Therefore we conclude that changes in the predictor are not associated with changes in the response.
# Also,The R-squared is 0.01193, so the model can explain 1.1% of the variability of the response variable which is very low.
```


______________________________________________________________________________________________________________________________

```{r}

setwd("C:/Users/hatha/Desktop/ISQA8086/RScripts")
library(readxl)
library(dplyr)
```

```{r}
##Bring in dataset
dataset <- read.csv("VH-Dataset.csv")
```


```{r}

str(dataset)
```

```{r}
##Checking for suspicious data
range(dataset$TempF)
range(dataset$Precipitation)
range(dataset$WaterTemp)
range(dataset$pH, na.rm = TRUE)
range(dataset$Conductivity)
range(dataset$Turbidity, na.rm = TRUE)
```

```{r}
##Remove unnecessary columns
beforesplit <-dataset[,-c(1)]
```

```{r}
##Create subset for data from West site
west <- subset(beforesplit,beforesplit$ObservationSite == "West")
```

```{r}
##Create subset for data from North site
north <-subset(beforesplit,beforesplit$ObservationSite == "North")

```

```{r}

##Quick summary
summary(beforesplit)
summary(west)
summary(north)
```


```{r}
##Linear regression to find out the connection between Turbidity and Conductivity
attach(dataset)
plot(Turbidity ~ Conductivity)
reg <- lm(Turbidity ~ Conductivity)
abline(reg)
summary(reg)
##Results show that there is no linear relationship
```


```{r}
##Linear regression to find out the connection between Turbidity and Conductivity (for west site)
attach(west)
plot(Turbidity ~ Conductivity)
regwest <- lm(Turbidity ~ Conductivity)
abline(regwest)
summary(regwest)
##Results show that there is no linear relationship
```


```{r}
##Linear regression to find out the connection between Turbidity and Conductivity (for north site)
attach(east)
plot(Turbidity ~ Conductivity)
regeast <- lm(Turbidity ~ Conductivity)
abline(regeast)
summary(regeast)
##Results show that there is no linear relationship
```

```{r}

##Linear regression to find out the connection between TempF and pH
attach(dataset)
plot(TempF ~ pH)
tempph <- lm(TempF ~ pH)
abline(tempph)
summary(tempph)
##Results show that there is no linear relationship

```
